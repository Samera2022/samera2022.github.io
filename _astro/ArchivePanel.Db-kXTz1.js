import{p as I,o as tt,a as et,c as at,b as W,i as K}from"./translation.BTAF_BXP.js";import{N as S,S as A,T as rt,U as it,X as st,t as nt,d as t,Z as l,O as v,P as _,a0 as d,a1 as b,Q as T,Y as g}from"./render.7h2Bo7UW.js";import{e as L,i as Q}from"./each.ExDfyQne.js";import{I as j}from"./zh_TW.CkfBuvkU.js";import{g as R}from"./url-utils.B8KdWwdh.js";function ot(k){const u=k.reduce((a,n)=>{const o=n.data.published.getFullYear();return a[o]||(a[o]=[]),a[o].push(n),a},{}),c=Object.keys(u).map(a=>{const n=Number.parseInt(a,10);return{year:n===9999?"置顶":n,posts:u[n]}});return c.sort((a,n)=>a.year==="置顶"?-1:n.year==="置顶"?1:n.year-a.year),c.forEach(a=>{a.posts.sort((n,o)=>{const P=new Date(n.data.published),h=new Date(o.data.published),m=P.getFullYear()===9999,x=h.getFullYear()===9999;return m&&!x?-1:!m&&x?1:m&&x?0:h.getTime()-P.getTime()})}),c}var lt=S('<span class="text-50"> </span>'),dt=S(`<a class="group btn-plain !block h-10 w-full rounded-lg hover:text-[initial]"><div class="flex flex-row justify-start items-center h-full"><div class="w-[15%] md:w-[10%] transition text-sm text-right text-50"> </div> <div class="w-[15%] md:w-[10%] relative dash-line h-full flex items-center"><div class="transition-all mx-auto w-1 h-1 rounded group-hover:h-5
                       bg-[oklch(0.5_0.05_var(--hue))] group-hover:bg-[var(--primary)]
                       outline outline-4 z-50
                       outline-[var(--card-bg)]
                       group-hover:outline-[var(--btn-plain-bg-hover)]
                       group-active:outline-[var(--btn-plain-bg-active)]"></div></div> <div class="w-[70%] md:max-w-[65%] md:w-[65%] text-left font-bold
                     group-hover:translate-x-1 transition-all group-hover:text-[var(--primary)]
                     text-75 pr-8 whitespace-nowrap overflow-ellipsis overflow-hidden"><!> </div> <div class="hidden md:block md:w-[15%] text-left text-sm transition
                     whitespace-nowrap overflow-ellipsis overflow-hidden text-30"> </div></div></a>`),vt=S(`<div><div class="flex flex-row w-full items-center h-[3.75rem]"><div class="w-[15%] md:w-[10%] transition text-2xl font-bold text-right text-75"> </div> <div class="w-[15%] md:w-[10%]"><div class="h-3 w-3 bg-none rounded-full outline outline-[var(--primary)] mx-auto
                  -outline-offset-[2px] z-50 outline-3"></div></div> <div class="w-[70%] md:w-[80%] transition text-left text-50"> </div></div> <!></div>`),ut=S('<div class="card-base px-8 py-6"></div>');function xt(k,u){it(u,!1);let c=I(u,"tags",28,()=>[]),a=I(u,"categories",28,()=>[]),n=I(u,"sortedPosts",24,()=>[]);const o=new URLSearchParams(window.location.search);c(o.has("tag")?o.getAll("tag"):[]),a(o.has("category")?o.getAll("category"):[]);const P=o.get("uncategorized");let h=nt([]);function m(r){if(r.getFullYear()===9999)return"PINNED";const e=(r.getMonth()+1).toString().padStart(2,"0"),s=r.getDate().toString().padStart(2,"0");return`${e}-${s}`}function x(r){return r.map(e=>`#${e}`).join(" ")}function C(r,e){if(!r||e.length===0)return"";for(const s of e)if(r.startsWith(s+"/"))return`/${r.substring(s.length+1)}/`;return""}tt(async()=>{let r=n();c().length>0&&(r=r.filter(e=>Array.isArray(e.data.tags)&&e.data.tags.some(s=>c().includes(s)))),a().length>0&&(r=r.filter(e=>{const s=e.data.category;return s?a().some(f=>s===f||s.startsWith(f+"/")):!1})),P&&(r=r.filter(e=>!e.data.category)),st(h,ot(r))}),et();var Y=ut();L(Y,5,()=>t(h),Q,(r,e)=>{var s=vt(),f=v(s),D=v(f),X=v(D,!0);l(D);var U=_(D,4),Z=v(U);l(U),l(f);var $=_(f,2);L($,1,()=>(t(e),d(()=>t(e).posts)),Q,(N,i)=>{var p=dt(),E=v(p),z=v(E),q=v(z,!0);l(z);var B=_(z,4),M=v(B);{var G=w=>{var y=lt(),F=v(y,!0);l(y),T(V=>g(F,V),[()=>(t(i),b(a()),d(()=>C(t(i).data.category,a())))]),A(w,y)};at(M,w=>{t(i),b(a()),d(()=>C(t(i).data.category,a()))&&w(G)})}var H=_(M);l(B);var O=_(B,2),J=v(O,!0);l(O),l(E),l(p),T((w,y,F)=>{W(p,"href",w),W(p,"aria-label",(t(i),d(()=>t(i).data.title))),g(q,y),g(H,` ${t(i),d(()=>t(i).data.title)??""}`),g(J,F)},[()=>(b(R),t(i),d(()=>R(t(i).slug,t(i).data.category))),()=>(t(i),d(()=>m(t(i).data.published))),()=>(t(i),d(()=>x(t(i).data.tags)))]),A(N,p)}),l(s),T(N=>{g(X,(t(e),d(()=>t(e).year))),g(Z,`${t(e),d(()=>t(e).posts.length)??""} ${N??""}`)},[()=>(b(K),t(e),b(j),d(()=>K(t(e).posts.length===1?j.postCount:j.postsCount)))]),A(r,s)}),l(Y),A(k,Y),rt()}export{xt as default};
